
<div class="main-wrapper" fxLayout="row" fxLayoutAlign="center center">
  <mat-card class="box">
    <b>Edit Profile</b>
      
      <form class="example-form" [formGroup]="editForm" >
          <br><br>
          <mat-card-content *ngFor="let item of patientData">

              <div class="example-action-buttons">
                  <button mat-button (click)="accordion.openAll()" style="float: right;">Expand All</button>
                </div>
                <mat-accordion class="example-headers-align" multi>
                  <mat-expansion-panel>
                    <mat-expansion-panel-header>
                      <mat-panel-title>
                        Personal data
                      </mat-panel-title>
                      <mat-panel-description> 
                        Type your details
                        <mat-icon>account_circle</mat-icon>
                      </mat-panel-description>
                    </mat-expansion-panel-header>
                
                    <div fxLayout="row" >
                    <mat-form-field>
                      <mat-label>Title</mat-label>
                      <select matNativeControl formControlName="title"  [(ngModel)]="item.title"  class="form-control" >
                        <option value="mr">mr</option>
                        <option value="mrs">mrs</option>
                        <option value="miss">miss</option>
                      </select>
  
                    </mat-form-field>

                    <mat-form-field>
                      <mat-label>First name</mat-label>
                      <input matInput formControlName="firstName"  [(ngModel)]="item.firstName">
                  
                    </mat-form-field>

                    <mat-form-field>
                      <mat-label>Last name</mat-label>
                      <input matInput formControlName="lastName"  [(ngModel)]="item.lastName">
                    
                    </mat-form-field>
            
                    <mat-form-field>
                      <mat-label>Email</mat-label>
                      <input matInput formControlName="emailId"   [(ngModel)]="item.emailId">
                    
                    </mat-form-field>

                    <mat-form-field>
                      <mat-label>DateOfBirth</mat-label>
                      <input matInput [matDatepicker]="picker" formControlName="dob"     [max]="maxDate"  [(ngModel)]="item.dob">
                      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                      <mat-datepicker #picker></mat-datepicker>
                  
                    </mat-form-field>
                
                    <mat-form-field>
                      <mat-label>Contact Number</mat-label>
                      <input matInput type="number" formControlName="contactNumber"   [(ngModel)]="item.contactNumber">
                  
                    </mat-form-field>
                  </div>
                
                  </mat-expansion-panel>
                  <mat-expansion-panel>
                    <mat-expansion-panel-header>
                      <mat-panel-title>
                        Demographics
                      </mat-panel-title>
                      <mat-panel-description>
                        Type demographics details here
                        <mat-icon>create</mat-icon>
                      </mat-panel-description>
                    </mat-expansion-panel-header>

                    <div fxLayout="row" >
                    <mat-form-field>
                    <mat-label>Gender</mat-label>
                      <select matNativeControl formControlName="gender"   class="form-control"  [(ngModel)]="item.gender">
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Other</option>
                      </select>
                     </mat-form-field>

                    
                    <mat-form-field>
                      <mat-label>Age</mat-label>
                      <input matInput formControlName="age"  [(ngModel)]="item.age">
                    </mat-form-field>

                    <mat-form-field>
                      <mat-label>Race</mat-label>
                      <mat-select formControlName="race"  [(ngModel)]="item.race">
                        <mat-option *ngFor="let race of races" [value]="race.value">
                          {{race.viewValue}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>

                    <mat-form-field>
                      <mat-label>Ethnicity</mat-label>
                      <mat-select formControlName="ethnicity"  [(ngModel)]="item.ethnicity">
                        <mat-option *ngFor="let ethniciti of ethnicitys" [value]="ethniciti.value">
                          {{ethniciti.viewValue}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>

                    
                      <mat-form-field  >
                        <mat-label>Languages Known</mat-label>
                        <mat-select multiple formControlName="languageList"  [(ngModel)]="item.languageList" >
                          <mat-option *ngFor="let lang of langugesData" [value]="lang" (click)="getLanguagesList(lang)"   >{{lang}} </mat-option>
                        </mat-select>
                      </mat-form-field>
                  
        
                    <mat-form-field>
                      <mat-label>Home Address</mat-label>
                      <input matInput formControlName="address"  [(ngModel)]="item.address" >
                      
                    </mat-form-field>
                  </div>

                  </mat-expansion-panel>
                
                  <mat-expansion-panel>
                    <mat-expansion-panel-header>
                      <mat-panel-title>
                        Emergency Contact Info
                      </mat-panel-title>
                      <mat-panel-description>
                        Type emergency contact info here
                        <mat-icon>contact_page</mat-icon>
                      </mat-panel-description>
                    </mat-expansion-panel-header>
                    

                    <div formArrayName="emergencyContactInfoList" *ngFor="let contactInfo of emergencyListControls; let i = index"  class="EmergencyContactInfo">
                      <div [formGroupName]="i">
                      <mat-card >
                      <div fxLayout="row" >

                    <mat-form-field >
                      <mat-label>First name</mat-label>
                      <input matInput formControlName="kinFirstName" [(ngModel)]="item.emergencyContactInfoList[i].kinFirstName" >              
                    </mat-form-field>

                    <mat-form-field>
                      <mat-label>Last name</mat-label>
                      <input matInput formControlName="kinLastName"  [(ngModel)]="item.emergencyContactInfoList[i].kinLastName"  >                    
                    </mat-form-field>
            
                    <mat-form-field>
                      <mat-label>Email</mat-label>
                      <input matInput formControlName="kinEmail" [(ngModel)]="item.emergencyContactInfoList[i].kinEmail" >
                    </mat-form-field>
                    
                    <mat-form-field>
                      <mat-label>Relationship</mat-label>
                      <input matInput formControlName="relationship" [(ngModel)]="item.emergencyContactInfoList[i].relationship" >
                    </mat-form-field>

                    <mat-form-field>
                      <mat-label>Address</mat-label>
                      <input matInput formControlName="kinAddress"  [(ngModel)]="item.emergencyContactInfoList[i].kinAddress"  >
                    
                    </mat-form-field>
            
                    <mat-form-field>
                      <mat-label>Contact</mat-label>
                      <input matInput formControlName="kincontactNumber" [(ngModel)]="item.emergencyContactInfoList[i].kincontactNumber" >
                      
                    </mat-form-field><br>
                  </div>

                    <mat-label >Do you need access to patient portal? </mat-label>
                    <mat-radio-group aria-label="Select an option" formControlName="portalAccess" [(ngModel)]="item.emergencyContactInfoList[i].portalAccess" >
                      <mat-radio-button value="yes"> Yes  </mat-radio-button>
                      &nbsp;<mat-radio-button value="no"> No</mat-radio-button>
                    </mat-radio-group>
                  
                  </mat-card>
                  </div>
                </div>
                
                    
                  </mat-expansion-panel>

                  <mat-expansion-panel>
                    <mat-expansion-panel-header>
                      <mat-panel-title>
                        Allergies
                      </mat-panel-title>
                      <mat-panel-description>
                        Inform if you have any allergies
                        <mat-icon>create</mat-icon>
                      </mat-panel-description>
                    </mat-expansion-panel-header>

                    <div formArrayName="allergys" *ngFor="let allergyControl of allergyControls; let i = index" >
                      <div [formGroupName]="i">
                        <mat-card>
                    <mat-form-field>
                      <mat-label>Allergies</mat-label>
                      <mat-select formControlName="allergyName" [(ngModel)]="item.allergys[i].allergyName"  >
                        <mat-option *ngFor="let dorpDownAllergy of allergyData" [value]="dorpDownAllergy.allergyName">
                          {{dorpDownAllergy.allergyName}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                    <mat-checkbox class="example-margin" formControlName="is_fatal" [(ngModel)]="item.allergys[i].is_fatal"   >is_fatal</mat-checkbox>

                    </mat-card> 
                    </div>
                  </div>
                  </mat-expansion-panel>
                </mat-accordion>

          </mat-card-content>
          <button mat-flat-button color="primary" class="btn-block" (click)="submitForm()"  >Submit</button>
      </form>
      <!-- <div class="alert" *ngIf="showMsg">
        <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span> 
        <strong> Data Saved Successfully!</strong> 
      </div> -->
  </mat-card>
</div>
